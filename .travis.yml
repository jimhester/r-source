language: c # or other C/C++ variants

addons:
  apt:
    sources:
      - r-packages-precise
    packages:
      - git-svn
      # from rocker depends
      - bash-completion
      - bison
      - debhelper
      - default-jdk
      - g++
      - gcc
      - gdb
      - gfortran
      - groff-base
      - libblas-dev
      - libbz2-dev
      - libcurl4-openssl-dev
      - libjpeg-dev
      - liblapack-dev
      - liblzma-dev
      - libncurses5-dev
      - libpango1.0-dev
      - libpcre3-dev
      - libpng-dev
      - libreadline-dev
      - libx11-dev
      - libxt-dev
      - subversion
      - texinfo
      - texlive-base
      - texlive-extra-utils
      - texlive-fonts-extra
      - texlive-fonts-recommended
      - texlive-generic-recommended
      - texlive-latex-base
      - texlive-latex-extra
      - texlive-latex-recommended
      - x11proto-core-dev
      - xauth
      - xdg-utils
      - xfonts-base
      - xvfb
      - zlib1g-dev

cache:
  - ccache

before_install:
  - tools/rsync-recommended
    # zlib
  - mkdir -p extra
  - pushd extra
  - wget http://archive.ubuntu.com/ubuntu/pool/main/z/zlib/zlib_1.2.8.dfsg.orig.tar.gz
  - tar xzf zlib_*.tar.gz
  - pushd `find . -name zlib-"*" -type d`
  -  ./configure --prefix=$HOME && make && make install
  - popd
  - popd

script:
  - git svn init https://svn.r-project.org/R/trunk
  - git update-ref refs/remotes/git-svn refs/remotes/origin/HEAD
  - git svn rebase
  - mkdir build;pushd build
  - ../configure
  - make && make check
